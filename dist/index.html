<style>*{margin:0;width:100%;height:100%}</style><canvas id="b"><script>var _,ea=[.4,.2,.4,0],ma=["#313","#324","#335"],oa=[.05,.03,.03],Ha=[1,1,.7],Ka=[.8,.8,.5,.7],La=[.3,.35,.33,0],Ma=[.6,.6,.5,.5],Sa=[.6,.1,.6,.5],Ta=document,Ua=localStorage,Va=(a,d,h,c,e,g,u)=>{var p=(a,d)=>{var h=c(111*a+37*d+a+d);if(50>a)if(a--,0>a)var g=0;else{g=a+Wa.abs(((d+3*(a>>2))%6+6)%6-2)>>2;var k=_;h(2)&&(k=p(a,d))<3*g?g=k:g*=3}else if(g=36,50<a||.1>h())g+=6;return g},x=Xa(e,.4,.2,.1,"sine",777,333),C=Xa(e,.5,.4,.2,"square",299,999,0,"sine",30),G=Xa(e,.4,.4,.2,"sawtooth",-99,299);return (e,l,z)=>{for(var n=12*e,k=12*l,r=a+" "+e+" "+l,q=c(111*e+37*l+e+l),b=[],v=p(e,l),H=50==e,F=H&&v>=p(e+1,l),t=-1;1>=t;t++)for(var y=-1;1>y;y++){var B=c(2147483647*(l>>3+y)+e>>3+t);b.push(B(2147483647))};var K=p(e+1,l),J=p(e,l+1),E=p(e,l-1);t=O(K,E,J);if(B=t>v&&K==t){y=t-v;t=P(144+y*y);var I=Za(y,12);y=[n,y/12,v+.3,.5];t=d(n,k,v,t,12,e,l,I,0,La,2/W(I),2,y)}else y=[n,0,v+.3,.5],t=d(n,k,v,12,12,e,l,0,0,La,2,2,y);t.floor=1;t=[t];K>v&&!B&&(I=K-v,K=d(n+12,k+12,K,I,12,e,l,4.7124,3.1416,La,I,2,y),t.push(K));J>v&&(I=J-v,K=d(n,k+12,J,I,12,e,l,4.7124,4.7124,La,I,2,y),t.push(K));E>v&&(I=E-v,K=d(n+12,k,E,I,12,e,l,4.7124,1.5708,La,I,2,y),t.push(K));B=0<e&&q(2)&&!B&&(50>e||52<e)||H;var T=(!q(9+v)||Ua.getItem(r)||3>e||50<e)&&!H;if(B){I=O(4+v/4,20)|0;B=q(4)+6;var A=H?4:q(3*e/50)+1;B-=B%A;K=H?12:B;var Q=!q(30-J-E+2*v);J=H?20:(Q?1:q(I)+4)*A;var R=v;F&&(R+=A);F=H?1:Q?B:q(J/4)+1;E=q(4)+1;var D=[],fa=0;I=H?La:T?Ma:Sa;var ta=_;if(!Q){Q=u[q(u.length)];for(ta in Q)if(.1>q())break;(Q=ta.match(/([A-Z]|^[a-z])[a-z]{2,}/g))&&(ta=Q[q(Q.length)])};Q=(b,a)=>{a.o!=$a||H||(D.map((a)=>{a.N=b.a}),U<fa&&(U++,U>=fa?(C(n,k,v),g("BUILDING LIBERATED")):G(n,k,v)))};for(var ja={s:-1,L:e,M:l,a:0,da:()=>{},o:ab,sa:(b,c)=>{if(U<fa){U=bb(0,U-c/999);b.ca=bb(U,b.ca);var k=b.ga(S,aa,cb);if(k){ba-=c;if(0>ba){var e=w(b.a,b.V,k);e?ba+=99:ha&&(ba=3E3);ha=e};k=ib([k.x,k.y,k.z],[S,aa,k.z]);e=P(lb(k,k));if(e<21+b.V/3&&b.H[mb].length<30+b.V-e&&3<e&&(ia-=c,0>ia&&(c=q(D.length),c=D[c],-.2<lb([k[0]/e,k[1]/e,k[2]/e],c.S)||c==na))){k=L[c.Z];for(var d in k)if(e=k[d],e.Ha<b.a){delete k[d];e.N=b.a+99;b.R(e);x(e.x,e.y,e.z);ua(c,d);ia=199;ra--;break}}}}else T||(T=1,Ua.setItem(r,1),Ua.setItem(a,"["+S+","+aa+","+R+"]"),D.map((b)=>{b.ha=[0,0,0,0];b.ea=Ma}));Ca!=U&&(b=O(1,U/fa),b*=b,ja.fa=b,ja.U=b*fa/1.8,Ca=U)}},na,Da,sa,va=q(3)+1;F--&&1<B&&1<K;){var Y=n+(12-B>>1),qa=k+(12-K>>1);fa+=B*K*J/7;Da=d(Y,qa,R,J,K,e,l,1.5708,0,I,A,A,y,Q,2<va?ta:_,ja);var Pa=d(Y+B,qa+K,R,J,K,e,l,1.5708,3.1416,I,A,A,y,Q,1<va?ta:_,ja),ya=d(Y+B,qa,R,J,B,e,l,1.5708,1.5708,I,A,A,y,Q,1==va?ta:_,ja),ka=d(Y,qa+K,R,J,B,e,l,1.5708,4.7124,I,A,A,y,Q,1==va?ta:_,ja);R>v&&va&&(sa=d(Y+B,qa,R,B,K,e,l,3.1416,0,I,A,A,y,Q),D.push(sa));R+=J;na=d(Y,qa,R,B,K,e,l,0,0,I,A,A,y,Q);D.push(ya,Da,Pa,ka,na);J>>=E;J-=J%A;0>=J?(J=A,B-=2*A,K-=2*A):(B-=A*(q(2)+1)*2,K-=A*(q(2)+1)*2);va=0};fa=5*P(fa)+9;var wa=fa/(A*A)|0,ra=0,da,f,ha,N,ba=3E3,M,xa=[],L={},ia=0,U=T?fa:0;y=H?-1:U/fa;ja.fa=y;ja.U=U*y/1.8;var Ca=U;for(y=q(3)+1;y--;)xa.push(b[q(b.length)]);var ua=(b,a,c)=>{for(var k=0;24<=a;)a-=24,k++;var e=b.ha[k];b.ha[k]=c?e|1<<a:e&~(1<<a)},w=(b,a,c)=>{for(var k=.45*P(A),e,d=O(9,q(9)+a/99|0);!e&&d--&&ra<wa;)if(ha?(da+=q(3)-1,f+=q(3)-1):(M=xa[q(xa.length)],N=D[q(D.length)],da=q(N.ia/A),f=q(N.wa/A)),e=0<=da&&0<=f&&da<N.ia/A&&f<N.wa/A&&(N==Da&&H||!H&&.001>N.S[2]||N==na||N==sa)){var g=nb((da+.5)*A,(f+.5)*A,k+.001,N.Da);if(c){var r=ib([c.x,c.y,c.z],g);e=P(lb(r,r));e=lb([r[0]/e,r[1]/e,r[2]/e],N.S);e=!a||-.2<e;if(0<r[2]||N==na)M&=-4}if(e){r=f*N.ia+da;var n=L[N.Z];n||(n={},L[N.Z]=n);if(e=!n[r])g=h(M,g[0],g[1],g[2],k),g.c=.001*N.S[0],g.i=.001*N.S[1],g.Ha=b+999+q(999),n[r]=g,ua(N,r,1),ra++}}return e},S=12*e+6,aa=12*l+6;for(e=z.ga(S,aa,cb);!T&&ra<wa;)w(0,0,e);t.push.apply(t,D);t.push(ja)}else 50>e&&!T&&v&&!q(9)&&(l=b[q(b.length)],e=O(3,.45*(P(e)+1)),e=h(l,n+6,k+6,v+e+3,e,-1,()=>{Ua.setItem(r,1)}),t.push(e));return t}};var cb=1,mb=2,$a=3,ab=4,ob=[0,1,2,0,2,3],Lb=(a)=>{var d=0;return (h,c,e,g,u,p,x,C,G,E,l,z,n,k,r,q)=>{var b=--d,v=Mb(a,[0,0,0,0,g,0,0,0,g,u,0,0,0,u,0,0]),H=g/l,F=u/z;z/=l;l=.02/l;var t=Mb(a,[0,0,z,l,H,0,z,l,H,F,z,l,0,F,z,l]),y=Nb(a,34963,new Uint16Array(ob));H=Ob(X(0,1,0,C),X(0,0,1,G));F=Ob(H,Pb(-h,-c,-e));C=Ob(X(0,0,1,-G),X(0,1,0,-C));G=Ob(Pb(h,c,e),C);l=nb(0,0,1,C);z=nb(g+.1,u+.1,.1,C);var B=nb(-.1,-.1,-.1,C),K={I:[O(h+B[0],h+z[0]),O(c+B[1],c+z[1]),O(e+B[2],e+z[2])],K:[bb(h+B[0],h+z[0]),bb(c+B[1],c+z[1]),bb(e+B[2],e+z[2])]};if(r){c=Ta.createElement("canvas");e=c.getContext("2d");h=99*g/u;c.width=99;c.height=h;e.fillText(r,(99-e.measureText(r).width)/2,10);r=e.getImageData(0,0,99,h).data;var J=Qb(a,99,h,new Uint8Array(r))}return{s:0,Z:b--,S:l,T:[[0,0],[g,0],[g,u],[0,u]],L:p,M:x,ia:g,wa:u,ea:E,Fa:v,qa:t,ha:[0,0,0,0],Aa:y,Ba:6,ka:F,Da:G,la:H,Ea:C,za:n,o:0,xa:q,ra:J,da:()=>{a.deleteBuffer(t);a.deleteBuffer(y);J&&a.deleteTexture(J)},W:()=>{return K},P:k}}};var Rb=(a,d,h)=>{var c=(h,C,G,E,l,z,n,k)=>{var r=()=>{var b=.005*F()+3E-4*(Wa.random()+1),a=F(9)+21;V.push((c,k,e)=>{if(e&1&&(c=c.pa(m,a+c.V)))return q(c.x,c.y,b,k),1})},q=(b,a,c,e,d)=>{b-=m.x;a-=m.y;if(b||a){e=e*d?d*k:k;a=Za(a,b);d=Z(a);b=W(a);var f=-a;a=Z(f);var g=W(f);f=m.c*g-m.i*a;a=m.i*g+m.c*a;f>c?0<a?a-=e:a+=e:f+=e;m.c=f*b-a*d;m.i=a*b+f*d}};var b=(b)=>{var a=H&Wa.pow(2,b)-1;H>>=b;return a},v=(b,a,c,e,k,d,f)=>{var g=[b,a,c];g=P(lb(g,g));wa.push(k,d,f,e);Pa.push(b,a,c,g)};var H=h,F=d(h),t=b(3),y=e(t)%11,B=e(b(2)+1)+bb(1,t-1),x=(b(1)+B)/(B+1),J=b(1),Ba=b(1),I=99*(b(5)+32)*l,T=(b(2)+1)/(14-y),A=6*b(4)/B,Q=b(2)|b(2),R=b(3),D=1.5*b(1),fa=.1,ta=[l/(l+2)],ja=[],na=3;R?5<R&&(R&=~(1<<F(R-5)+1)):R|=1<<F(3);if(1==R){var Da=1,sa=.4;fa=.2}else R%2?(Da=.7,sa=.3):(Da=.9,sa=.4);for(;na--;){var va=R&1;R>>=1;va?(ta.unshift(sa+F()*fa),ja.unshift(Da+F()*fa)):(ta.unshift(0),ja.unshift(sa+F()*fa))};H=h;var Y=O(1,b(2)/2),qa=b(2)/3,Pa=[],ya=[],ka=[],wa=[],ra=[],da=[],f=(y%2&&3<B||!J)&&Ba||1==y;Y*=Y;if(f){var ha=y+1,N=3/ha,ba=l}else ha=y,N=3/(2*ha),ba=W(N)*l;for(var M=0,xa=N,L=0;L<y;L++)da.push(xa),ra.push(B),xa+=3.1416/ha;for(L=0;L<y;L++){for(var ia=ra[L],U=da[L],Ca=M+J,ua=Z(U)*l*x/W(3/ia),w=W(U)*l,S=0;S<ia;S++){var aa=(S+L)*A,la=((S+1)%ia+L)*A,Tb=T*Z(U),Na=Q>>S%2&1?Tb:0,Ia=Q>>(S+1)%ia%2&1?Tb:0,Oa=3.1416*M/ia+6.2832*S/ia,ca=Oa+6.2832/ia,pa=ya.length,Ea=W(Oa)*ua,Ja=Z(Oa)*ua,za=W(ca)*ua,Aa=Z(ca)*ua;if(L<y-1){var Fa=ra[L+1],pb=da[L+1],Ya=(S+L+1)*A,qb=((S+1)%Fa+L+1)*A,Vb=T*Z(pb),Wb=Q>>S%2&1?Vb:0,uc=Q>>(S+1)%Fa%2&1?Vb:0,jb=Z(pb)*l*x/W(3/Fa),db=W(pb)*l,rb=3.1416*Ca/Fa+6.2832*S/Fa,Xb=rb+6.2832/Fa,sb=W(rb)*jb,tb=Z(rb)*jb,ub=W(Xb)*jb,vb=Z(Xb)*jb,wb=F()+.5,xb=F()+.5,yb=(Ea+za+ub)*wb/3,zb=(Ja+Aa+vb)*wb/3,Ab=(2*w+db)*wb/3,Bb=(za+sb+ub)*xb/3,Cb=(Aa+tb+vb)*xb/3,Db=(w+2*db)*xb/3;v(za,Aa,w,Ia,yb,zb,Ab);v(Ea,Ja,w,Na,yb,zb,Ab);v(sb,tb,db,Wb,yb,zb,Ab);v(za,Aa,w,Ia,Bb,Cb,Db);v(sb,tb,db,Wb,Bb,Cb,Db);v(ub,vb,db,uc,Bb,Cb,Db);ya.push(pa++,pa++,pa++,pa++,pa++,pa++);J?ka.push(1,0,0,la,0,1,0,aa,0,0,1,Ya,1,0,0,la,0,1,0,Ya,0,0,1,qb):(0!=L||f?ka.push(0,1,1,la,1,1,0,aa,1,1,0,Ya):ka.push(0,0,1,la,0,1,0,aa,1,1,0,Ya),L!=y-2||f?ka.push(1,1,0,la,0,1,1,Ya,1,1,0,qb):ka.push(1,0,0,la,0,1,1,Ya,0,0,1,qb));Oa=ca};var kb=[],vc=f?T:0;0==L&&kb.push(ba);for(L==y-1&&kb.push(-ba);kb.length;){var Ga=kb.splice(0,1)[0];ya.push(pa++,pa++,pa++);var Eb=F()+.5,eb=(Ea+za)*Eb/3,fb=(Ja+Aa)*Eb/3,gb=(2*w+Ga)*Eb/3;0<Ga?(v(Ea,Ja,w,Na,eb,fb,gb),v(za,Aa,w,Ia,eb,fb,gb)):(v(za,Aa,w,Ia,eb,fb,gb),v(Ea,Ja,w,Na,eb,fb,gb));v(0,0,Ga,vc,eb,fb,gb);f?J?ka.push(1,0,0,0<Ga?aa:la,0,1,0,0<Ga?la:aa,0,0,1,L*A):ka.push(0,1,1,0<Ga?aa:la,1,1,0,0<Ga?la:aa,0,1,0,L*A):ka.push(0,1,0,0<Ga?aa:la,0,1,0,0<Ga?la:aa,1,0,1,0)}};M=Ca};var Yb=Mb(a,ka),Zb=Mb(a,Pa),$b=Mb(a,wa),ac=Nb(a,34963,new Uint16Array(ya)),V=[];k||(k=3E-5*F()+2E-6);for(var wc=b(2);wc--;)r();if(b(1)){var xc=.01*F()+.001,Fb=F(4)+3,Gb=Fb*Fb;V.push((b,a,c)=>{if(c&1&&(b=b.ga(m.x,m.y,$a,Fb))){c=b.x-m.x;var e=b.y-m.y;c=c*c+e*e;if(c<Gb)return q(b.x,b.y,xc,a,-(Gb-c)/Gb-1),1}})}if(b(1)){var Hb=.005*F()+3E-4;V.push((b,a,c)=>{if(c&1)return.001>Wa.abs(m.c)&&.001>Wa.abs(m.i)&&(b=6*F(),m.c=W(b)*Hb,m.i=Z(b)*Hb),q(m.x+999*m.c,m.y+999*m.i,Hb,a),1})}if(V.length){for(var yc=V.length;yc--;){var zc=V.splice(F(V.length),1)[0];V.push(zc)}if(1==b(2)){var Ac=.6*F()+.1;V.unshift((b,a,c)=>{if(c&1)return b=Wa.pow(Ac,a/999),m.c*=b,m.i*=b,1})}if(b(1)){var Bc=V.splice(0,1)[0];V.push((b,a,c)=>{if(!b.V)return Bc(b,a,c)})}if(b(1)){var Cc=V.splice(0,1)[0],Dc=F(2),Ec=F(4E3)+999;V.push((b,a,c)=>{var e=m.a/Ec|0;if(e%2&&Dc||e)return Cc(b,a,c)})}if(b(1)){var Fc=F(9)+3,Gc=V.splice(0,1)[0];V.push((b,a,c)=>{if(b.pa(m,Fc))return Gc(b,a,c)})}}if(1>Y&&b(3)){var Ib=1E-6*F()+1E-7,bc=1E6*Ib;V.unshift((b,a,c)=>{if(c&2&&(b=b.pa(m,9))&&(b=b.z-m.z))return c=m.F/bc,c=bc*c*c/2,c=c>(Wa.abs(b)+c)/2,m.F+=(c&&0<b||!c&&0>b?-Ib:Ib)*a,2})}if(2==b(3)){if(F(2)){var cc=h>>6,Jb=.9*l,Kb=1}else if(.45<l||z)cc=h,Jb=l/2,Kb=F(2)*l|2;var dc=(b,a)=>{for(var e=Kb,k=l-Jb;e--&&a;){var d=6*e/Kb;d=c(cc,m.x+W(d)*k,m.y+Z(d)*k,m.z,Jb);d.o=m.o;b.R(d)}}}if(b(1))V.push((b,a,c)=>{if((m.c||m.i)&&c&4)return b=Za(m.i,m.c),m.G=b,4}),b(1)&&V.push((b,a,c)=>{if((m.c||m.i)&&c&8)return b=P(m.c*m.c+m.i*m.i),m.J-=a*b/m.b,8});else{var Hc=.01*F()+.001;V.push((b,a,c)=>{if(c&4)return b=P(m.c*m.c+m.i*m.i),m.G+=Hc*a*(b+.001),4})};var Ic=z;z||(z=(F(1E4)+2E4)*l);var ec=[],Qa=0,Ra=0,hb=0,fc;.45<=l&&(fc=g(h,I,P(2*l)));var gc=l*l*2|0,m={s:1,ua:h,Z:p++,b:l,Ca:ja,ea:ta,x:C,y:G,z:E,ta:qa,sa:(b,a)=>{var c=-1;V.map((e)=>{(e=e(b,a,c))&&(c&=~e)});if(hb){if(Qa||Ra){var e=Za(Ra,Qa);Qa/=hb;Ra/=hb;var k=1-Qa*Qa-Ra*Ra;m.c+=W(e)*k/3E3;m.i+=Z(e)*k/3E3};Ra=Qa=hb=0};e=m.x-b.X;k=m.y-b.$;var d=m.z-b.na;0<z&&m.a>z-(Ic?0:(e*e+k*k+d*d)*b.V/9)&&m.Y(b);ec=[]},P:(b,a)=>{if(a.s){if(a.o==$a&&m.o==mb||a.o==cb&&5==m.o)gc--,m.N=b.a,0>gc&&m.Y(b,a);if(m.o==a.o){b=m.y-a.y;var c=a.b+m.b;Qa+=(m.x-a.x)/c;Ra+=b/c;hb++}}ec.push(a)},da:()=>{a.deleteBuffer(ac);a.deleteBuffer(Zb);a.deleteBuffer($b);a.deleteBuffer(Yb);m.O&&m.O.va()},Y:(b,a)=>{if(!m.v&&(m.v=m.a,dc&&dc(b,a),n&&n(b),a&&a!=m&&m.o==mb)){a=l;var e=d(m.a)(),k=0>z;for(u(m.x,m.y,m.z,l);a-- >e;){var f=6*a/l,g=W(f);f=Z(f);k=c(k?h:32788,m.x+.001*g,m.y+.001*f,m.z,k?.2:.05,5E3,_,.001);k.c=.005*g;k.i=.005*f;k.o=5;b.R(k);k=0}}},o:mb,a:0,J:0,ba:D,G:0,c:0,i:0,F:0,N:0,qa:Yb,Aa:ac,Ba:ya.length,Fa:Zb,aa:Y,Ja:$b,W:()=>{return{I:[m.x-m.b,m.y-m.b,m.z-m.b],K:[m.x+m.b,m.y+m.b,m.z+m.b]}},ya:I,O:fc};return m};var e=(a)=>{for(var c=1,e=1;a;){var d=e;e+=c;c=d;a--}return e},g=Sb(h,d),u=Ub(h,.7,.1,777,.7,.4),p=0;return c},hc=(a,d)=>{var h=(a,c)=>{if(a=ic(a,E,2,z))for(var e=a.I[1],b=a.K[0],k=a.K[1],d=a.I[0];d<=b;d++)for(var g=e;g<=k;g++)c(n.oa(d,g),d,g);return a},c=(a)=>{a.o%2&&0<a.s&&(a.Ca=Ha,a.ea=Ka);return h(a.W(),(c,e,b)=>{!a.s&&a.L==e&&a.M==b&&a.floor?c.unshift(a):c.push(a)})};var e=(a)=>{a.s&&(jc(n.ja,a),1==a.s&&a.O&&a.O.va());var c=n.H[a.o];c&&jc(c,a);-1!=a.s&&g(a);a.da()},g=(a)=>{return h(a.W(),(c)=>{jc(c,a)})};var u=(a)=>{var d=()=>{k--;var b=n.ja[k];b.a+=a;if(1==b.s&&b.v)b.a>b.v+399&&e(b);else if(1==b.s&&!ic(b.W(),E,2,z)||-1==b.s&&!kc(E,b.L,b.M))e(b);else{var d=_;b.sa(n,a);if(0<b.s){b.F-=5E-5*a*b.aa;for(var r=a,l=9,q=()=>{var a=b.x,e=b.y,k=b.z,q=b.c*r,v=b.i*r,p=b.F*r;g(b);b.x+=q;b.y+=v;b.z+=p;var u=b.W(),F,z,C,E={};h(u,(c)=>{var d=()=>{var d=c[h];if(!E[d.Z]&&!b.v){E[d.Z]=1;var l=_,q=_;if(d.s){var v=d.x-b.x,p=d.y-b.y,y=d.z-b.z,x=d.b+b.b,t=b.c*b.c+b.i*b.i+b.F*b.F;v*v+p*p+y*y<x*x&&t&&(d.P(n,b),d.v&&g(d),b.P(n,d))}else if(ic(d.W(),u,3)&&(p=nb(b.x,b.y,b.z,d.ka),y=p[2],Wa.abs(y)<b.b)){var H,B=p;x=nb(a,e,k,d.ka);v=nb(b.c,b.i,b.F,d.la);v=v[2];t=_;0<v?(t=b.b+y,t/=v):(t=b.b-y,t/=-v);t=r-t;var A=lc(d.T,x,b.b);if(A){var D=A[0]-x[0];A=A[1]-x[1];var f=x[2];(D*D+A*A+f*f<b.b*b.b||mc(d.T,x[0],x[1])&&f<b.b)&&b.o!=cb&&b.Y(n)}if(t<=r){q=nc(p,nb(a,e,k,d.ka),t/r);if(0>v&&mc(d.T,q[0],q[1])&&0<t)l=t-.001;else if(q=P(b.b*b.b-y*y),(H=lc(d.T,p,q))||mc(d.T,p[0],p[1])){q=bb(0,t-.001);p=r;for(y=0;9>y;y++)if(x=(q+p)/2,t=nb(a+x*b.c,e+x*b.i,k+x*b.F,d.ka),D=t[2],D=P(b.b*b.b-D*D),mc(d.T,t[0],t[1])&&0>v)p=x,B=t,H=_;else if(D=lc(d.T,t,D)){A=D[0]-t[0];f=D[1]-t[1];var G=t[2];A*A+f*f+G*G<b.b*b.b?(B=t,H=D,p=x):q=x}else q=x;H?(v=Za(H[1]-B[1],H[0]-B[0])-1.5708,v=oc([X(1,0,0,Wa.acos(B[2]/b.b)),X(0,0,1,v),d.la]),0>nb(b.c,b.i,b.F,v)[2]&&(l=q)):l=q};q=()=>{var a=b.c,c=b.i,e=b.F,k=b.ta;if(H){var f=Za(H[1]-B[1],H[0]-B[0])-1.5708;var g=Wa.acos(B[2]/b.b);var h=oc([X(1,0,0,g),X(0,0,1,f),d.la]);f=oc([d.Ea,X(0,0,1,-f),X(1,0,0,-g)])}else h=d.la,f=d.Ea;a=nb(a,c,e,h);k=nb(a[0],a[1],a[2]*-k,f);b.c=k[0];b.i=k[1];b.F=k[2]}}};_!=l&&(_==F||F>l)&&(z=d,F=l,C=q)}};for(var h=c.length;h--;)d()});_!=F?(q=bb(0,F),b.x=a+b.c*q,b.y=e+b.i*q,b.z=k+b.F*q,r-=q,q=z,q.P&&q.P(n,b),b.P(n,z),C&&C(),d=!l--||.001>=r||b.v):(b.v||(c(b),b.O&&(q=n.X-b.x,v=n.$-b.y,p=n.na-b.z,q*q+v*v+p*p<99*b.b*b.b*4?b.O.La(b.x,b.y,b.z):b.O.va())),d=!0)};!d;)q();b.Oa=[b.x,b.y,b.z];b.Pa=[b.c,b.i,b.F]}}};n.V=n.ca;n.ca=0;n.a+=a;for(var k=n.ja.length;k;)d()};for(var p=[],x=0;12>x;x++){for(var C=[],G=0;12>G;G++)C.push([]);p.push(C)};var E,l=0,z=[12,12],n={a:0,ja:[d],H:{0:[],1:[d],2:[],3:[],4:[],5:[]},ca:0,V:0,oa:(a,c)=>{var e;kc(E,a,c)&&(e=p[(a%12+12)%12][(c%12+12)%12]);return e},pa:(a,c)=>{return n.ga(a.x,a.y,a.o==$a?mb:cb,c)},ga:(a,c,e,b)=>{e=n.H[e];b||(b=144);var d,k=b*b;e.map((b)=>{var e=a-b.x,g=c-b.y;e=e*e+g*g;if(e<k||!k)d=b,k=e});return d},R:(a)=>{if(-1==a.s?kc(E,a.L,a.M):c(a)){var e=n.H[a.o];e?e.push(a):n.H[a.o]=[a];a.s&&n.ja.push(a)}},Ma:(a)=>{for(a+=l;9<=a;)u(9),a-=9;l=a},Ga:(c,d,g,b,h,l)=>{n.X=c;n.$=d;n.na=g;n.Ia=b;n.Na=h;n.ma=l;h=pc(c/12-6);g=pc(d/12-6);c=pc(c/12+6)-1;d=pc(d/12+6)-1;if(_==E)for(E={I:[h,g],K:[c,d]};h<=c;h++)for(l=g;l<=d;l++){var k=a(h,l,n);k.map(n.R)}else if(h!=E.I[0]||g!=E.I[1])for(b=E,E={I:[h,g],K:[c,d]};h<=c;h++)for(l=g;l<=d;l++)kc(b,h,l)||(k=n.oa(h,l),k.map((a)=>{a.s||kc(E,a.L,a.M)||e(a)}),k.length=0,k=a(h,l,n),k.map(n.R))}};n.Ga(d.x,d.y,d.z,0,0,0);c(d);return n};var qc=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],Ob=(a,d)=>{for(var h=[],c=0;16>c;c++){for(var e=c>>2,g=c%4,u=0,p=0;4>p;p++)u+=a[e+4*p]*d[p+4*g];h[e+4*g]=u}return h};var oc=(a)=>{var d=qc;a.map((a)=>{a&&(d=Ob(d,a))});return d},X=(a,d,h,c)=>{var e=Z(c);c=W(c);var g=1-c;return[a*a*g+c,d*a*g-h*e,h*a*g-d*e,0,a*d*g+h*e,d*d*g+c,h*d*g-a*e,0,a*h*g+d*e,d*h*g+a*e,h*h*g+c,0,0,0,0,1]},Pb=(a,d,h)=>{return[1,0,0,0,0,1,0,0,0,0,1,0,a,d,h,1]};with(Math){P=sqrt,pc=floor,Z=sin,W=cos,O=min,bb=max,Za=atan2,Wa=Math};var rc=(a)=>{return (d)=>{var h=a+d;return (a)=>{var c=1E5*Z(h++);c-=pc(c);a&&(c=c*a|0);return c}}};var kc=(a,d,h)=>{return a.I[0]<=d&&a.I[1]<=h&&a.K[0]>=d&&a.K[1]>=h},ic=(a,d,h,c)=>{for(var e=!0,g=[],u=[],p=0;p<h;p++){var x=a.I[p],C=a.K[p],G=d.I[p],E=d.K[p];c&&(x=pc(x/c[p]),C=pc(C/c[p]));C=O(C,E);x=bb(x,G);G=C-x;if(e=e&&0<=G)g.push(x),u.push(C)}if(e)return{I:g,K:u}};var nb=(a,d,h,c)=>{var e=c[3]*a+c[7]*d+c[11]*h+c[15]||1;return[(c[0]*a+c[4]*d+c[8]*h+c[12])/e,(c[1]*a+c[5]*d+c[9]*h+c[13])/e,(c[2]*a+c[6]*d+c[10]*h+c[14])/e]},lb=(a,d)=>{return a[0]*d[0]+a[1]*d[1]+a[2]*d[2]};var nc=(a,d,h)=>{for(var c=[],e=d.length;e--;)c[e]=a[e]*h+d[e]*(1-h);return c},ib=(a,d)=>{return[a[0]-d[0],a[1]-d[1],a[2]-d[2]]};var mc=(a,d,h)=>{for(var c,e=0,g=a.length-1;e<a.length;g=e++){var u=a[e][0],p=a[e][1],x=a[g][0];g=a[g][1];p>h!=g>h&&d<(x-u)*(h-p)/(g-p)+u&&(c=!c)}return c},lc=(a,d,h)=>{var c=d[0],e=d[1],g=a[a.length-1];h*=h;for(var u=0;u<a.length;u++){var p=a[u],x=_,C=((c-g[0])*(p[0]-g[0])+(e-g[1])*(p[1]-g[1]))/sc(g,p);0>C?x=g:1<C?x=p:x=[g[0]+C*(p[0]-g[0]),g[1]+C*(p[1]-g[1])];C=sc(d,x);g=p;if(C<h){var G=x;h=C}}return G};var sc=(a,d)=>{var h=a[0]-d[0];a=a[1]-d[1];return h*h+a*a},tc=(a)=>{a&&a.disconnect()};var Jc=(a,d,h,c,e,g,u)=>{a.gain.value=0;a.gain.setValueAtTime(0,d);a.gain.linearRampToValueAtTime(h,d+e);a.gain.linearRampToValueAtTime(c,d+g);a.gain.linearRampToValueAtTime(0,d+u)},Ub=(a,d,h,c,e,g)=>{var u=a.sampleRate,p=d*u|0,x=a.createBuffer(1,p,u);for(u=x.getChannelData(0);p--;)u[p]=2*Wa.random()-1;return (p,u,E,l)=>{l||(l=1);var z=a.createBufferSource();z.buffer=x;z.loop=!0;var n=a.createBiquadFilter();n.type="lowpass";n.Q.value=0;n.frequency.value=c;var k=a.createGain();Jc(k,a.currentTime,e*l,g*l,h,.2*d,d);var r=a.createPanner();r.refDistance=27*e;r.setPosition(p,u,E);z.connect(n);n.connect(k);k.connect(r);r.connect(a.destination);z.start();z.stop(a.currentTime+d);z.onended=()=>{[r,k,z,n].map(tc)}}};var Xa=(a,d,h,c,e,g,u,p,x,C)=>{return (G,E,l)=>{var z=a.currentTime,n=a.createOscillator();n.frequency.setValueAtTime(g,z);n.frequency.linearRampToValueAtTime(u,z+d);n.type=e;var k=a.createGain();Jc(k,z,h,c,0,.2*d,d);if(x){var r=a.createOscillator();r.frequency.value=C;r.type=x;var q=a.createGain();q.gain.value=-999;r.connect(q);q.connect(n.detune);r.start();r.stop(z+d)}if(p){var b=a.createBiquadFilter();b.type="highpass";b.Q.value=0;b.frequency.value=p;n.connect(b);b.connect(k)}else n.connect(k);var v=a.createPanner();v.refDistance=27*h;k.connect(v);v.connect(a.destination);v.setPosition(G,E,l);n.start();n.stop(z+d);n.onended=()=>{[n,k,r,q,b].map(tc)}}};var Sb=(a,d)=>{var h=["sine","sawtooth","triangle","square"];return (c,e,g)=>{var u,p,x,C,G,E=d(c),l=h[E(4)],z=h[E(3)];return{La:(c,d,h)=>{if(!u){u=a.createOscillator();var k=E(9);u.frequency.value=40-4*g+k*k*k;u.type=l;p=a.createGain();p.gain.value=.1*g/2;x=a.createOscillator();x.frequency.value=999*(E(2)+1)/e;x.type=z;C=a.createGain();C.gain.value=-999;G=a.createPanner();G.refDistance=3*(g+1)/2;u.connect(p);x.connect(C);C.connect(u.detune);p.connect(G);G.connect(a.destination);x.start();u.start()}G.setPosition(c,d,h)},va:()=>{u&&([u,p,C,G].map(tc),u.stop(),x.stop(),u=_)}}}};var jc=(a,d)=>{for(var h=a.length;0<h;)h--,a[h]==d&&a.splice(h,1)},Mb=(a,d)=>{return Nb(a,34962,new Float32Array(d))};var Nb=(a,d,h)=>{var c=a.createBuffer();a.bindBuffer(d,c);a.bufferData(d,h,35044);return c},Kc=(a,d,h)=>{a.bindBuffer(a.ARRAY_BUFFER,d);a.vertexAttribPointer(h,4,5126,!1,0,0);a.enableVertexAttribArray(h)};var Qb=(a,d,h,c)=>{var e=a.createTexture();a.bindTexture(3553,e);a.texImage2D(3553,0,6408,d,h,0,6408,5121,c);a.texParameteri(3553,10241,9729);a.texParameteri(3553,10242,33071);a.texParameteri(3553,10243,33071);return e},Lc=(a,d,h)=>{d=a.createShader(d);a.shaderSource(d,h);a.compileShader(d);return d};((a)=>{var d=()=>{var I=(e)=>{ya=requestAnimationFrame(I);var d=O(99,e-la);la=e;w.Ma(d);c.activeTexture(33984);c.bindTexture(3553,E);c.framebufferTexture2D(36160,36064,3553,E,0);e=0;f.v&&(e=Z(O(1.5,(w.a-f.v)/999)));w.Ga(f.x,f.y,f.z+f.b+72*e/2,(f.J+1.5)*(1-e),f.ba,f.G-1.5);e=a.listener;e.setPosition(f.x,f.y,f.z);e.setOrientation(W(f.G),Z(f.G),0,0,0,1);e=bb(0,(ha+99-w.a)/3E3);d=Pb(Z(da)*f.b/8+(Pa()-.5)*e,e,Wa.abs(W(da)*f.b/8)+(Pa()-.5)*e);e=X(1,0,0,w.Ia);var h=X(0,0,1,w.ma),l=X(0,1,0,-f.J);Ja=oc([Aa,X(0,0,1,-f.G),l,za,Pb(.6*f.b/2+.05,0,0)]);f.Ka=oc([Aa,l,za,[.6,0,0,0,0,.1,0,0,0,0,.1,0,0,0,0,1],X(1,0,0,-.5),X(0,1,0,1.5+f.J)]);d=oc([e,d,h,Pb(-w.X,-w.$,-w.na)]);w.H[ab].sort((a,b)=>{var c=w.X-12*a.L;a=w.$-12*a.M;var e=w.X-12*b.L;b=w.$-12*b.M;return c*c+a*a-e*e-b*b});T(n,d,Fa);Fa=d;d=G;G=E;E=d;c.readPixels(0,0,k,r,6408,5121,x);C.data.set(x);g.putImageData(C,0,0);g.globalCompositeOperation="destination-over";d=_;d=Ob(n,e);e=(nb(0,1,.2,d)[1]*r-r)/2|0;h=6.2832/b*k;h=((w.ma-1.5)%6.2832+6.2832)%6.2832*k/b%h-h/2+k/2;for(l=w.ma*k/b%k-k;l<k&&612>f.x;)g.drawImage(u,l,e),l+=k;d=(nb(0,Ea,pa,d)[1]*r+r)/2;d=g.createRadialGradient(h,d,r/9,h,d,r);h=1+Z(w.a/999)/9;d.addColorStop(.1*h,B);d.addColorStop(.11*h,K);d.addColorStop(1,J);g.fillStyle=d;g.fillRect(0,0,k,e+r);g.fillStyle="#313";g.fillRect(0,bb(0,e+r),k,r);g.globalCompositeOperation="source-over";g.textBaseline="top";g.fillStyle=g.strokeStyle="#fff";g.globalAlpha=Wa.abs(Z(w.a/99))/2+.5;g.font="18px sans-serif";g.textAlign="center";S&&999>w.a-S&&g.fillText(aa,k/2,r/2);if(!f.v)for(e=_,e=O(1,1-(L-w.a+399)/399),3<M&&(g.globalAlpha=e),g.lineWidth=9-7*e,e=30>M?"red":"#4f4",g.fillStyle=e,3>M&&(g.strokeStyle="red"),g.fillRect(k-ba-18,18,M,18),g.strokeRect(k-ba-18,18,ba,18),e=U,d=k-ba-27;0<e;)d-=16,g.fillText("\u26a1",d,18),e--;g.globalAlpha=1},T=(a,b,e)=>{c.clear(16640);for(var d=w.H[ab],g=[],h=O(d.length,16),l=Z(w.a/399)/9+1,n=0;n<h;n++){var p=d[n];g.push(12*p.L+6,12*p.M+6,P(p.U)*l+12,p.fa/2)}c.uniform4fv(D.C,g);c.uniform1i(D.D,h);c.uniform1i(D.A,0);c.uniform1i(D._,1);c.bindTexture(3553,G);c.activeTexture(33985);c.uniform2f(D.B,1/k,1/r);c.uniformMatrix4fv(D.f,!1,a);c.uniformMatrix4fv(D.e,!1,b);c.uniformMatrix4fv(D.g,!1,e);a=O(1.5,w.X/408);pa=Z(a);Ea=W(a);c.uniform4f(D.m,Ea,0,pa,.1*(pa+1));a=.5;b=bb(0,ha+99-w.a)/99;a+=b;b=bb(0,.5*(1-(w.a-f.N-399))/399);c.uniform4f(D.w,9,a,.5-b,1.1+b);for(var q in w.H)q!=ab&&w.H[q].map((a)=>{c.enable(2884);Kc(c,a.Fa,A);Kc(c,a.qa,Q);c.bindBuffer(34963,a.Aa);var b=a.ea,e=.2;a.N&&a.N+199>w.a&&(e+=(a.N+199-w.a)/399);c.uniform1i(D.h,a.s);if(a.s){var d=a.Ja,g=Pb(a.x,a.y,a.z);var k=X(0,1,0,-a.J);var h=X(1,0,0,-a.ba);var f=X(0,0,1,-a.G);h=[g,f,a.Ka,k,h];g=[0,0,0,0];if(k=w.oa(pc(a.x/12),pc(a.y/12)))f=k[0],f.s||(g=f.za);var l=a.a/a.ya;f=0;k=a.Ca;if(a.v){c.disable(2884);f=(a.a-a.v)/399;l=f*f;var n=1-.99*l;f=3*l*a.b/n;h.splice(1,0,[n,0,0,0,0,n,0,0,0,0,n,0,0,0,0,1]);k=nc(ea,k,l);b=nc(ea,b,l);l=a.v/a.ya+(a.a-a.v)/399}c.uniform1f(D.j,6*l);c.uniform1f(D.k,f);h=oc(h)}else f=a,d=f.qa,h=f.Da,c.uniform3fv(D.l,f.S),c.uniform3f(D.y,f.ia,f.wa,f.xa&&f.ra?f.xa.fa:0),f.ra&&c.bindTexture(3553,f.ra),c.uniform1fv(D.z,f.ha),k=oa,g=f.za;Kc(c,d,R);c.uniformMatrix4fv(D.d,!1,h);c.uniform4fv(D.t,b);c.uniform3fv(D.u,k);c.uniform4fv(D.n,g);c.uniform1f(D.x,e);c.drawElements(4,a.Ba,5123,0)})};var ja=(a,b,c,e)=>{var d=ra(a,b,c,e,.49);f=d;f.aa=1-f.aa/2;f.ta=0;f.O=_;f.o=cb;f.Y=()=>{f.v=f.a;f==d&&(na("HULL FAILURE"),F(f.x,f.y,f.z))};f.sa=(a,b)=>{var c=ca[37]||ca[65],e=ca[39]||ca[68],d=bb(ca[38],ca[87]),g=ca[40]||ca[83],h=ca[32],l=.004;if(ca[16]||d<Oa)l*=2;f.J=3*Na/r;f.G=3*Ba/k;var n=Z(f.G),p=W(f.G),q=Z(f.G-1.5),x=W(f.G-1.5),u=0,t=0;e&&(u+=.004*x,t+=.004*q);c&&(u-=.004*x,t-=.004*q);c=W(da);d&&(u+=l*p,t+=l*n,da+=l*b);g&&(u-=.004*p,t-=.004*n,da-=.004*b);d=W(da);(0<=d&&0>c||0>d&&0<=c)&&y(f.x,f.y,f.z-f.b);h&&ia+699>h&&(f.F=.015,ia=0);f.c=u;f.i=t;h=0;if(ia+699>f.a)for(u=a.H[ab],t=0;t<u.length;)d=u[t++],g=f.x-(12*d.L+6),l=f.y-(12*d.M+6),g=g*g+l*l,g<d.U*d.U&&(g=P(g),g=d.fa*(d.U-g)/d.U,h+=g*g*P(d.U)/4);U=P(h);M=O(ba,M+U*b*.01/O(1,(M+9)/30));if(Ia&&3<=M&&(f.a>ha+180||M>=ba)){M-=3;u=Z(f.J);t=W(f.J);ha=ha+180+b>f.a?ha+180:f.a;b=nb(0,0,0,Ja);var w=ra(f.ua,f.x+b[0],f.y+b[1],f.z+b[2],.1,450);v(f.x,f.y,f.z);w.o=$a;w.O=_;w.P=(a,b)=>{5==b.o||b==f||w.ta&&!b.s||w.Y(a,b)};w.c=t*p*.02;w.i=t*n*.02;w.F=.02*u;w.aa/=2;a.R(w)}!va&&612<f.x&&(va=1,na("YOU ESCAPED"),Ua.setItem(0,Y+1),B="#FF5",K="#CCC",J="#99E");3<=xa&&3>M&&!h?(na("WEAPON OFF-LINE"),Ca=1):30<=xa&&30>M&&!ua?(na("SHIELD OFF-LINE"),ua=1):3>xa&&3<=M&&Ca?(na("WEAPON ONLINE"),Ca=0):60<M&&(ua=0);xa=M};f.P=(a,b)=>{if(b.s){if(b.o!=$a)if(5==b.o){if(32788==b.ua)N++,ba=Wa.pow(N,.8),M+=9,L=a.a,H(f.x,f.y,f.z);else{var c=f;ja(b.ua,f.x,f.y,f.z);f.J=c.J;f.ba=c.ba;f.G=c.G;c.v=c.a;f.a=c.a;a.R(f);na("WEAPON UPGRADE")};b.v=b.a}else f.N+399>a.a?b.v=b.a:(t(f.x,f.y,f.z),c=30/.45*b.b,M>=c?(M-=c,f.N=a.a,ha=a.a+399,b.v=b.a):f.Y(a,b))}else 0<b.S[2]&&(ia=f.a)}};var na=(a)=>{var b=new SpeechSynthesisUtterance(a);b.rate=.8;speechSynthesis.speak(b);b.onend=function(){S=w.a-999};aa=a;S=w.a},Da=()=>{cancelAnimationFrame(ya);for(var a in w.H)w.H[a].map((a)=>{a.da()});sa()};var sa=(a)=>{k=innerWidth;r=innerHeight;h.width=e.width=k;h.height=e.height=r;x=new Uint8Array(k*r*4);C=g.createImageData(k,r);a&&(G=Qb(c,k,r),E=Qb(c,k,r),l=c.createFramebuffer(),z=c.createRenderbuffer(),c.bindFramebuffer(36160,l),c.bindRenderbuffer(36161,z),c.renderbufferStorage(36161,33189,k,r),c.framebufferRenderbuffer(36160,36096,36161,z));q=k/r;b=2*Wa.atan(.3936*q);a=1/.3936;var d=1/-71.775;n=[a/q,0,0,0,0,-a,0,0,0,0,72.225*d,-1,0,0,32.4*d,0];c.viewport(0,0,k,r);a=qa(0);for(d=5;--d;){g.fillStyle=ma[d-2];for(var f=0;f<k;){var p=(a(r)+4*r)*P(6-d)/25+r/2,t=(a(k/19)+k/49)/(q*d);g.fillRect(f,p,t+1,r);f+=t}};u.src=e.toDataURL()};var va,Y;(Y=Ua.getItem(0)/1)||(Y=7);var qa=rc(Y),Pa=qa(9),ya;sa(1);onresize=sa;var ka=Ua.getItem(Y),wa;ka?wa=JSON.parse(ka):wa=[0,0,0];var ra=Rb(c,qa,a);ka=Va(Y,p,ra,qa,a,na,[Ta,e]);var da=0,f;ja(0,wa[0],wa[1],wa[2]+2);var ha=f.ba=0,N=150,ba=Wa.pow(N,.8),M=ba,xa=M,L=0,ia=0,U=0,Ca,ua,w=hc(ka,f),S,aa,la=0,Ba=0,Na=0,Ia,Oa,ca={38:0,87:0};e.onmousedown=(a)=>{a.button||(Ta.pointerLockElement==e?f.v?(Da(),d()):Ia=w.a:e.requestPointerLock())};e.onmouseup=()=>{Ia=0};e.onmousemove=(a)=>{Ta.pointerLockElement==e&&(Ba-=a.movementX,Na=O(r/2,bb(-r/2,Na-a.movementY/2)))};onkeydown=(a)=>{a=a.keyCode;ca[a]||(ca[a]=w.a)};onkeyup=(a)=>{a=a.keyCode;ca[a]=0;16==a&&(Oa=w.a)};var pa,Ea,Ja,za=Pb(.6*f.b,.3*-f.b,.45*-f.b),Aa=Pb(0,0,f.b);var Fa=qc;I(0)};var h=Ta.createElement("canvas"),c=h.getContext("webgl"),e=Ta.getElementById("b"),g=e.getContext("2d"),u=Ta.createElement("img"),p=Lb(c),x,C,G,E,l,z,n,k,r,q,b,v=Ub(a,.3,.01,399,.9,.5),H=Xa(a,.2,.1,.05,"square",999,2E3,599),F=Ub(a,2,.2,499,1.5,1),t=Xa(a,.5,.4,.2,"sawtooth",299,-99),y=Ub(a,.05,.01,2E3,.1,.05),B="#000",K="#c6c",J="#112";c.getExtension("OES_standard_derivatives");c.enable(2929);c.depthFunc(513);c.clearColor(0,0,0,0);c.cullFace(1028);var Ba=Lc(c,35633,"precision lowp float;attribute vec4 a;attribute vec4 b;attribute vec4 c;uniform mat4 d;uniform mat4 e;uniform mat4 g;uniform mat4 f;uniform vec3 l;uniform vec4 m;uniform lowp int h;uniform float j;uniform float k;varying vec4 s;varying vec4 o;varying vec4 p;varying vec4 q;varying vec4 r;void main(){vec4 t=a;vec3 u=l;if(h>0){t+=b.w*a*sin(j+c.w)+k*b;u=(d*vec4(a.xyz/a.w,1.)-d*vec4(vec3(0.), 1.)).xyz;}vec4 v=d*vec4(t.xyz,1.);t=e*v;p=c;o=t;q=f*g*v;r=vec4(mat3(e)*u-mat3(e)*vec3(0.),(dot(u,m.xyz)+1.)*m.w);s=vec4(v.xyz,a.w);gl_Position=f*t;}"),I=Lc(c,35632,"#extension GL_OES_standard_derivatives:enable\nprecision lowp float;uniform vec4 t;uniform vec3 u;uniform vec4 w;uniform float x;uniform sampler2D A;uniform sampler2D _;uniform vec2 B;uniform lowp int h;uniform vec3 y;uniform float z[4];uniform vec4 n;uniform vec4 C[16];uniform lowp int D;varying vec4 s;varying vec4 o;varying vec4 p;varying vec4 q;varying vec4 r;vec4 E(vec2 F,int G,inout float H){vec4 I=texture2D(A,F);if(I.w>.1){float J=7./float(7-G);H+=J;I*=J;}return I;}void main(){float L=length(o.xyz);float M=0.;if(L<72.){M=clamp((5184.-L*L)/5184.,0.,1.);}vec3 N=vec3(0.);float O=0.;for(int i=0;i<16;i++){if(i<D){vec4 P=C[i];vec2 Q=P.xy-s.xy;float R=sqrt(Q.x*Q.x+Q.y*Q.y);if(R<P.z){float S=(P.z-R)/P.z;float T=S*S*sqrt(P.z)/4.;O+=T;N+=vec3(.5,P.w,.5-P.w)*T;}}}if(O>0.){N/=O;}float U=clamp(1.-L/w.x,0.,1.)*-dot(o.xyz/L,r.xyz)*w.y+x+r.w+O/9.;float V=1.;vec3 W;vec3 X;vec4 Z=floor(p);if(h>0){vec3 Y=smoothstep(vec3(0.0),fwidth(p.xyz)*2.*s.w*(1.-L/72.),p.xyz);V=min(min(Y.x,Y.y),Y.z);W=t.xyz;X=u;U+=t.w;}else{float a=min(p.x-Z.x,(p.y-Z.y)*p.z);float b=max(p.x-Z.x,1.-(1.-p.y+Z.y)*p.z);float c=(1.+O*O)*p.w;if(a<c||b>(1.-c)){V=min(a,1.-b)/c*(1.-max(0.,L/72.))*(1.-c)+c;V*=V*V;}a = Z.y*y.x+Z.x;for(int i=0;i<4;i++){if(a<24.&&a>=0.) {U=max(U,mod(floor(z[i]/pow(2.,a)), 2.)*6.);};a-=24.;};N=mix(u,N,sqrt(O));X=N;vec2 g=p.xy/y.xy-.5;W=vec3(t.xy, t.z+t.w*(g.x+g.y));if(y.z>0.){Z=texture2D(_,1.-p.yx/y.yx);U+=Z.w*6.*y.z;V=max(V,Z.w*y.z);}}vec4 e=vec4(mix(X,max(mix(vec3(0.),W,U),N*.4*(1.-min((s.z-(s.x-n.x)*n.y-n.z)/n.w,1.))),V), M);vec2 f=(q.xy/q.w)/2.+.5;O=0.;Z=E(f,0,O);for(int i=1;i<7;++i){L=float(i);Z+=E(f+vec2(B.x,0.)*L,i,O);Z+=E(f-vec2(B.x,0.)*L,i,O);Z+=E(f+vec2(0.,B.y)*L,i,O);Z+=E(f-vec2(0.,B.y)*L,i,O);}if(O>0.){Z/=O;O=sqrt(Z.w)*w.z;e=vec4((e.xyz*O+Z.xyz*(1.-O))*w.w,e.a);};gl_FragColor=e;}"),T=c.createProgram();c.attachShader(T,Ba);c.attachShader(T,I);c.linkProgram(T);c.useProgram(T);var A=c.getAttribLocation(T,"a"),Q=c.getAttribLocation(T,"c"),R=c.getAttribLocation(T,"b"),D={};for(Ba=21;Ba--;)I="fdegtuwxABhyzjkmnlCD_"[Ba],D[I]=c.getUniformLocation(T,I);return d})(new AudioContext)();</script></canvas>